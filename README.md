# SageMaker Canvas時系列モデル分析ダッシュボード

このリポジトリは、Amazon SageMaker Canvasで作成した時系列モデルの結果を分析するためのダッシュボードを提供します。

## 概要

SageMaker Canvas時系列モデル分析ダッシュボードは、Canvasで作成した時系列モデルの予測結果を使用して、SKUごとに説明可能な指標を表示するStreamlitアプリケーションです。このダッシュボードを使用することで、時系列モデルの予測精度や要因を詳細に分析することができます。

## 機能

- **データ概要と評価指標**
  - 選択した商品のデータ概要（商品名、期間、レコード数）
  - モデル評価指標（RMSE、MAE、MAPE、過剰在庫率、欠品率）

- **時系列可視化**
  - 日次売上高の実績vs予測グラフ（最新30日分、調整可能）
  - 特徴量重要度のグラフ
  - 特徴量の部分依存（重要度が高い特徴量3つ）

- **需要要因分析**
  - 需要変動要因の円グラフ
  - 価格とクーポン率の交互作用効果

- **交互作用効果**
  - 主要な交互作用効果の視覚化と解釈

- **異常検出**
  - 標準偏差の2倍を超える誤差を持つデータポイントのテーブル表示
  - 異常値の時系列表示

## 入力データ

- 学習データ：`data/train/SKU_rev_train.csv`
- テストデータ：`data/test/SKU需要予測_test.csv`
- 出力（予測）結果：`data/result/result_summary.csv`

## 商品IDと商品名のマッピング

- 0: カップラーメン しお
- 1: ハイチュウ グレープ
- 2: ポテトチップス コンソメパンチ

## 使い方

### 依存ライブラリのインストール

```bash
pip install -r app/requirements.txt
```

### アプリケーションの実行

```bash
cd app
streamlit run streamlit_app.py
```

ブラウザが自動的に開き、ダッシュボードが表示されます。

### ダッシュボードの使用方法

1. サイドバーから分析したい商品（SKU）を選択します。
2. 分析期間のスライダーを調整して、特定の期間のデータを表示できます。
3. 「時系列可視化」セクションでは、表示日数を調整して、最新の売上データと予測データを比較できます。
4. 各セクションでは、データに基づいた分析結果が視覚的に表示されます。

## Dockerを使用する場合

開発環境をDockerで構築することもできます。

1. 開発環境の起動:

```bash
docker compose up -d
```

2. コンテナ内でアプリケーションを実行:

```bash
docker compose exec app streamlit run app/streamlit_app.py
```

3. 開発環境の停止:

```bash
docker compose down
```

## 詳細設計

詳細な設計ドキュメントは[docs/design.md](docs/design.md)を参照してください。
